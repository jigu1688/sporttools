# 中小学运动会编排系统设计方案

## 一、需求分析

### 1. 中小学运动会特点
- 参赛人数众多，年级班级复杂
- 项目类型多样，包括径赛、田赛、集体项目等
- 赛程安排紧凑，时间冲突风险高
- 需要考虑场地资源限制
- 重视公平性，分组合理
- 数据统计和成绩公布要求及时准确

### 2. 核心需求
- **基础数据管理**：学校信息、年级班级管理、运动员管理、项目管理
- **报名管理**：学生报名、班级报名、项目报名限制
- **赛程编排**：自动生成赛程、手动调整赛程、场地分配、时间冲突检测
- **分组管理**：根据性别、年级、成绩等自动分组
- **裁判管理**：裁判分配、评分标准管理
- **成绩管理**：成绩录入、实时更新、排名计算
- **数据统计**：总分统计、单项统计、团体统计
- **公告管理**：赛事公告、成绩公布、通知推送
- **导出功能**：赛程表导出、秩序册导出、成绩册导出
- **移动端支持**：运动员、教练、裁判、家长等角色的移动端访问

## 二、系统设计

### 1. 系统架构

#### 1.1 整体架构
- **前端**：React + Ant Design + Ant Design Charts
- **后端**：FastAPI + SQLAlchemy + PostgreSQL
- **移动端**：React Native 或 微信小程序
- **数据存储**：PostgreSQL + Redis
- **文件存储**：MinIO 或 云存储

#### 1.2 系统分层
- **表现层**：前端界面和移动端应用
- **业务逻辑层**：处理核心业务逻辑
- **数据访问层**：数据库操作
- **基础设施层**：缓存、消息队列、文件存储等

### 2. 功能模块设计

#### 2.1 基础数据管理
- 学校信息管理：学校基本信息、运动会基本信息
- 年级班级管理：年级设置、班级管理
- 运动员管理：运动员信息录入、导入导出
- 项目管理：项目设置、项目类型、项目规则

#### 2.2 报名管理
- 学生报名：个人报名、班级报名
- 报名审核：教练审核、管理员审核
- 报名统计：各项目报名人数统计
- 报名限制：项目人数限制、个人报名项目数限制

#### 2.3 赛程编排
- 自动编排：根据项目类型、报名人数、场地资源等自动生成赛程
- 手动调整：支持拖拽调整赛程、时间、场地
- 冲突检测：自动检测时间冲突、场地冲突
- 场地管理：场地资源管理、场地分配

#### 2.4 分组管理
- 自动分组：根据性别、年级、成绩等条件自动分组
- 手动调整：支持手动调整分组
- 分组规则：可配置的分组规则
- 分组查看：各项目分组情况查看

#### 2.5 裁判管理
- 裁判信息管理：裁判基本信息、专业领域
- 裁判分配：自动分配裁判、手动调整
- 评分标准：各项目评分标准管理
- 裁判评分：裁判评分录入

#### 2.6 成绩管理
- 成绩录入：手动录入、批量导入、电子设备对接
- 实时更新：成绩实时更新、排名实时计算
- 成绩查询：运动员成绩查询、项目成绩查询
- 成绩修正：成绩修正、申诉处理

#### 2.7 数据统计
- 总分统计：个人总分、班级总分、年级总分
- 单项统计：各项目成绩分布、破纪录统计
- 团体统计：团体总分排名、各奖项统计
- 数据分析：成绩对比分析、趋势分析

#### 2.8 公告管理
- 赛事公告：赛事通知、赛程变更通知
- 成绩公布：实时成绩公布、最终成绩公布
- 通知推送：短信通知、微信通知

#### 2.9 导出功能
- 秩序册导出：PDF格式秩序册
- 赛程表导出：Excel、PDF格式赛程表
- 成绩册导出：Excel、PDF格式成绩册
- 证书导出：获奖证书模板导出

### 3. 角色设计

#### 3.1 管理员
- 系统设置、用户管理
- 基础数据维护
- 赛程编排审批
- 成绩终审

#### 3.2 教练
- 运动员管理
- 学生报名审核
- 查看赛程和成绩
- 团体成绩统计

#### 3.3 裁判
- 查看分配的项目和赛程
- 成绩录入
- 评分标准查看

#### 3.4 运动员
- 查看个人赛程
- 查询个人成绩
- 接收赛事通知

#### 3.5 家长
- 查看子女赛程
- 查询子女成绩
- 接收赛事通知

### 4. 流程设计

#### 4.1 运动会筹备流程
1. 系统初始化：设置运动会基本信息
2. 基础数据导入：导入学校、年级、班级、学生数据
3. 项目设置：设置运动会项目
4. 报名开始：学生/班级报名
5. 报名结束：报名截止，统计报名数据
6. 赛程编排：生成初步赛程
7. 赛程调整：手动调整赛程、场地分配
8. 赛程发布：发布最终赛程

#### 4.2 运动会进行流程
1. 赛事开始：按照赛程进行比赛
2. 成绩录入：裁判录入成绩
3. 成绩审核：教练/管理员审核成绩
4. 成绩公布：实时公布成绩和排名
5. 数据统计：实时统计总分和团体成绩
6. 赛事结束：最终成绩汇总

#### 4.3 运动会结束流程
1. 成绩终审：确认最终成绩
2. 奖项评定：根据成绩评定奖项
3. 证书生成：生成获奖证书
4. 数据归档：运动会数据归档
5. 总结报告：生成运动会总结报告

## 三、技术选型

### 1. 前端技术栈
- **框架**：React 19
- **UI组件库**：Ant Design 6.x
- **图表库**：Ant Design Charts 2.6.7
- **状态管理**：Redux Toolkit
- **路由管理**：React Router DOM 7.x
- **API请求**：Axios
- **表单处理**：Formik + Yup

### 2. 后端技术栈
- **框架**：FastAPI 0.100+
- **ORM**：SQLAlchemy 2.x
- **数据库**：PostgreSQL 15
- **缓存**：Redis 7.x
- **认证**：JWT + OAuth2
- **API文档**：Swagger UI (自动生成)

### 3. 移动端技术栈
- **框架**：微信小程序 (考虑到中小学场景，微信小程序更适合)

### 4. 基础设施
- **容器化**：Docker + Docker Compose
- **部署**：Nginx + Gunicorn
- **CI/CD**：GitHub Actions
- **监控**：Prometheus + Grafana

## 四、数据库设计

### 1. 核心数据表

#### 1.1 学校信息表 (schools)
| 字段名 | 数据类型 | 描述 |
|--------|----------|------|
| id | UUID | 学校ID |
| name | VARCHAR(255) | 学校名称 |
| address | TEXT | 学校地址 |
| contact | VARCHAR(255) | 联系人 |
| phone | VARCHAR(20) | 联系电话 |
| created_at | TIMESTAMP | 创建时间 |
| updated_at | TIMESTAMP | 更新时间 |

#### 1.2 运动会表 (sports_meets)
| 字段名 | 数据类型 | 描述 |
|--------|----------|------|
| id | UUID | 运动会ID |
| school_id | UUID | 学校ID |
| name | VARCHAR(255) | 运动会名称 |
| start_date | DATE | 开始日期 |
| end_date | DATE | 结束日期 |
| status | VARCHAR(20) | 状态（筹备中、报名中、编排中、进行中、已结束） |
| created_at | TIMESTAMP | 创建时间 |
| updated_at | TIMESTAMP | 更新时间 |

#### 1.3 年级班级表 (classes)
| 字段名 | 数据类型 | 描述 |
|--------|----------|------|
| id | UUID | 班级ID |
| school_id | UUID | 学校ID |
| grade | VARCHAR(20) | 年级 |
| name | VARCHAR(50) | 班级名称 |
| created_at | TIMESTAMP | 创建时间 |
| updated_at | TIMESTAMP | 更新时间 |

#### 1.4 运动员表 (athletes)
| 字段名 | 数据类型 | 描述 |
|--------|----------|------|
| id | UUID | 运动员ID |
| school_id | UUID | 学校ID |
| class_id | UUID | 班级ID |
| student_id | VARCHAR(50) | 学生ID |
| name | VARCHAR(100) | 姓名 |
| gender | VARCHAR(10) | 性别 |
| birth_date | DATE | 出生日期 |
| height | DECIMAL(5,2) | 身高 |
| weight | DECIMAL(5,2) | 体重 |
| created_at | TIMESTAMP | 创建时间 |
| updated_at | TIMESTAMP | 更新时间 |

#### 1.5 项目表 (events)
| 字段名 | 数据类型 | 描述 |
|--------|----------|------|
| id | UUID | 项目ID |
| sports_meet_id | UUID | 运动会ID |
| name | VARCHAR(100) | 项目名称 |
| type | VARCHAR(20) | 项目类型（径赛、田赛、集体项目） |
| gender | VARCHAR(10) | 性别限制（男、女、混合） |
| grade_range | VARCHAR(50) | 年级范围 |
| max_participants | INTEGER | 最大参赛人数 |
| min_participants | INTEGER | 最小参赛人数 |
| unit | VARCHAR(20) | 成绩单位 |
| is_timed | BOOLEAN | 是否计时项目 |
| rules | TEXT | 项目规则 |
| created_at | TIMESTAMP | 创建时间 |
| updated_at | TIMESTAMP | 更新时间 |

#### 1.6 报名信息表 (registrations)
| 字段名 | 数据类型 | 描述 |
|--------|----------|------|
| id | UUID | 报名ID |
| sports_meet_id | UUID | 运动会ID |
| athlete_id | UUID | 运动员ID |
| event_id | UUID | 项目ID |
| class_id | UUID | 班级ID |
| status | VARCHAR(20) | 报名状态（待审核、已通过、已拒绝） |
| created_at | TIMESTAMP | 创建时间 |
| updated_at | TIMESTAMP | 更新时间 |

#### 1.7 赛程表 (schedules)
| 字段名 | 数据类型 | 描述 |
|--------|----------|------|
| id | UUID | 赛程ID |
| sports_meet_id | UUID | 运动会ID |
| event_id | UUID | 项目ID |
| round | VARCHAR(20) | 轮次（预赛、决赛等） |
| group | VARCHAR(20) | 组别 |
| venue | VARCHAR(100) | 场地 |
| start_time | TIMESTAMP | 开始时间 |
| end_time | TIMESTAMP | 结束时间 |
| status | VARCHAR(20) | 状态（未开始、进行中、已结束） |
| created_at | TIMESTAMP | 创建时间 |
| updated_at | TIMESTAMP | 更新时间 |

#### 1.8 分组信息表 (groups)
| 字段名 | 数据类型 | 描述 |
|--------|----------|------|
| id | UUID | 分组ID |
| schedule_id | UUID | 赛程ID |
| name | VARCHAR(50) | 分组名称 |
| type | VARCHAR(20) | 分组类型（性别、年级等） |
| created_at | TIMESTAMP | 创建时间 |
| updated_at | TIMESTAMP | 更新时间 |

#### 1.9 运动员分组表 (athlete_groups)
| 字段名 | 数据类型 | 描述 |
|--------|----------|------|
| id | UUID | ID |
| group_id | UUID | 分组ID |
| athlete_id | UUID | 运动员ID |
| lane | INTEGER | 跑道号/道次 |
| created_at | TIMESTAMP | 创建时间 |

#### 1.10 成绩表 (results)
| 字段名 | 数据类型 | 描述 |
|--------|----------|------|
| id | UUID | 成绩ID |
| schedule_id | UUID | 赛程ID |
| athlete_id | UUID | 运动员ID |
| event_id | UUID | 项目ID |
| group_id | UUID | 分组ID |
| value | DECIMAL(10,3) | 成绩值 |
| rank | INTEGER | 排名 |
| is_record | BOOLEAN | 是否破纪录 |
| status | VARCHAR(20) | 状态（待审核、已通过、已拒绝） |
| created_at | TIMESTAMP | 创建时间 |
| updated_at | TIMESTAMP | 更新时间 |

#### 1.11 裁判表 (referees)
| 字段名 | 数据类型 | 描述 |
|--------|----------|------|
| id | UUID | 裁判ID |
| name | VARCHAR(100) | 裁判姓名 |
| phone | VARCHAR(20) | 联系电话 |
| specialty | VARCHAR(100) | 专业领域 |
| created_at | TIMESTAMP | 创建时间 |
| updated_at | TIMESTAMP | 更新时间 |

#### 1.12 裁判分配表 (referee_assignments)
| 字段名 | 数据类型 | 描述 |
|--------|----------|------|
| id | UUID | 分配ID |
| schedule_id | UUID | 赛程ID |
| referee_id | UUID | 裁判ID |
| role | VARCHAR(50) | 裁判角色 |
| created_at | TIMESTAMP | 创建时间 |
| updated_at | TIMESTAMP | 更新时间 |

## 五、前端设计

### 1. 页面结构

#### 1.1 管理端页面
- **登录页**：管理员、教练、裁判登录
- **仪表盘**：运动会概览、待办事项、统计数据
- **基础数据管理**：学校信息、年级班级、运动员管理、项目管理
- **报名管理**：报名审核、报名统计
- **赛程编排**：赛程生成、赛程调整、场地分配
- **分组管理**：分组生成、分组调整
- **成绩管理**：成绩录入、成绩审核、成绩查询
- **数据统计**：总分统计、单项统计、团体统计
- **公告管理**：公告发布、通知推送
- **导出功能**：秩序册、赛程表、成绩册导出

#### 1.2 移动端页面
- **首页**：运动会概览、赛程查询
- **我的赛事**：个人报名项目、个人赛程、个人成绩
- **赛程查询**：按日期、项目、场地查询赛程
- **成绩查询**：按项目、运动员查询成绩
- **公告通知**：查看公告和通知

### 2. 关键界面设计

#### 2.1 赛程编排界面
- 日历视图：直观展示每日赛程
- 拖拽调整：支持拖拽调整赛程时间和场地
- 冲突提示：实时显示时间和场地冲突
- 批量操作：支持批量调整赛程

#### 2.2 成绩录入界面
- 快速录入：支持扫描运动员二维码快速录入
- 实时计算：自动计算排名和总分
- 批量导入：支持Excel批量导入成绩
- 成绩修正：支持成绩修正和申诉处理

## 六、后端设计

### 1. API设计

#### 1.1 认证API
- POST /api/v1/auth/login - 用户登录
- POST /api/v1/auth/logout - 用户登出
- GET /api/v1/auth/me - 获取当前用户信息

#### 1.2 运动会API
- GET /api/v1/sports-meets - 获取运动会列表
- POST /api/v1/sports-meets - 创建运动会
- GET /api/v1/sports-meets/{id} - 获取运动会详情
- PUT /api/v1/sports-meets/{id} - 更新运动会
- DELETE /api/v1/sports-meets/{id} - 删除运动会

#### 1.3 项目API
- GET /api/v1/events - 获取项目列表
- POST /api/v1/events - 创建项目
- GET /api/v1/events/{id} - 获取项目详情
- PUT /api/v1/events/{id} - 更新项目
- DELETE /api/v1/events/{id} - 删除项目

#### 1.4 报名API
- GET /api/v1/registrations - 获取报名列表
- POST /api/v1/registrations - 创建报名
- GET /api/v1/registrations/{id} - 获取报名详情
- PUT /api/v1/registrations/{id} - 更新报名状态
- DELETE /api/v1/registrations/{id} - 删除报名

#### 1.5 赛程API
- GET /api/v1/schedules - 获取赛程列表
- POST /api/v1/schedules/generate - 生成赛程
- GET /api/v1/schedules/{id} - 获取赛程详情
- PUT /api/v1/schedules/{id} - 更新赛程
- DELETE /api/v1/schedules/{id} - 删除赛程

#### 1.6 成绩API
- GET /api/v1/results - 获取成绩列表
- POST /api/v1/results - 录入成绩
- GET /api/v1/results/{id} - 获取成绩详情
- PUT /api/v1/results/{id} - 更新成绩
- DELETE /api/v1/results/{id} - 删除成绩

### 2. 核心业务逻辑

#### 2.1 赛程编排算法
- 基于贪心算法的赛程生成
- 考虑项目优先级、场地限制、时间冲突
- 支持手动调整和自动优化

#### 2.2 分组逻辑
- 根据性别、年级自动分组
- 考虑参赛人数和公平性
- 支持自定义分组规则

#### 2.3 成绩计算逻辑
- 自动计算排名
- 处理并列情况
- 计算总分和团体成绩
- 检测破纪录情况

## 七、部署与实施

### 1. 部署架构
- **开发环境**：Docker Compose 本地部署
- **测试环境**：Docker Compose 测试服务器部署
- **生产环境**：Docker + Kubernetes 集群部署

### 2. 部署流程
1. 安装 Docker 和 Docker Compose
2. 配置环境变量
3. 启动数据库和缓存服务
4. 启动后端服务
5. 构建并部署前端应用
6. 配置 Nginx 反向代理
7. 配置 SSL 证书

### 3. 实施计划

| 阶段 | 时间 | 任务 |
|------|------|------|
| 需求确认 | 1周 | 与学校确认具体需求和细节 |
| 系统设计 | 2周 | 完成系统设计、数据库设计、API设计 |
| 后端开发 | 4周 | 完成后端API开发和测试 |
| 前端开发 | 4周 | 完成前端页面开发和测试 |
| 移动端开发 | 3周 | 完成微信小程序开发和测试 |
| 系统集成 | 2周 | 完成前后端集成和测试 |
| 测试优化 | 2周 | 完成系统测试和性能优化 |
| 部署上线 | 1周 | 完成系统部署和上线 |
| 培训使用 | 1周 | 对管理员、教练、裁判进行培训 |

## 八、测试与优化

### 1. 测试计划
- **单元测试**：对核心业务逻辑进行单元测试
- **集成测试**：测试API接口和前后端集成
- **系统测试**：测试完整的业务流程
- **性能测试**：测试系统在高并发情况下的性能
- **用户测试**：邀请学校用户进行实际使用测试

### 2. 优化策略
- **数据库优化**：合理设计索引、优化查询语句
- **缓存优化**：使用Redis缓存热点数据
- **前端优化**：代码分割、懒加载、图片优化
- **后端优化**：异步处理、负载均衡

## 九、运维与支持

### 1. 运维计划
- **监控系统**：部署Prometheus + Grafana监控系统
- **日志管理**：使用ELK Stack进行日志管理
- **定期备份**：数据库定期备份和恢复测试
- **安全更新**：定期更新系统和依赖包

### 2. 技术支持
- 提供7x24小时技术支持
- 定期进行系统维护和优化
- 提供系统使用培训和文档
- 持续迭代和功能更新

## 十、系统价值

1. **提高效率**：自动化编排赛程，减少人工工作量
2. **保证公平**：科学分组和赛程安排，确保比赛公平性
3. **实时透明**：成绩实时更新和公布，提高赛事透明度
4. **数据支撑**：详细的数据分析和统计，为学校体育工作提供数据支持
5. **提升体验**：便捷的报名、查询和通知功能，提升参赛体验
6. **可扩展性**：支持不同规模的运动会，可根据学校需求进行定制

## 十一、风险评估

| 风险 | 影响 | 应对措施 |
|------|------|----------|
| 需求变更 | 项目延期 | 建立需求变更管理流程，严格控制变更范围 |
| 技术难点 | 开发受阻 | 提前进行技术调研和原型开发，解决关键技术问题 |
| 数据安全 | 数据泄露 | 实施严格的权限控制和数据加密措施 |
| 系统性能 | 响应缓慢 | 进行性能测试和优化，使用缓存和负载均衡 |
| 用户接受度 | 使用率低 | 提供完善的培训和文档，设计友好的用户界面 |

## 十二、总结

本方案设计了一套完整的中小学运动会编排系统，覆盖了运动会的全过程管理，包括基础数据管理、报名管理、赛程编排、分组管理、成绩管理、数据统计等功能。系统采用了现代化的技术栈，具有良好的可扩展性和可维护性，能够满足不同规模中小学运动会的需求。

该系统的实施将大大提高运动会的组织效率，保证比赛的公平性，提升参赛体验，为学校体育工作提供有力的数据支持。