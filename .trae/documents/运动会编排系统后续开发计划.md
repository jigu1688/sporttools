# 运动会编排系统-报名管理功能优化计划

## 1. 核心设计原则
- **数据一体化**：直接复用学生管理模块的学生数据，确保数据一致性
- **操作便捷性**：以班级（男、女）为最小操作单元，支持批量点选报名
- **流程适配性**：符合小学场景，支持班主任线下组织报名后，体育老师统一录入
- **状态清晰**：实时显示报名状态，避免重复报名

## 2. 功能模块设计

### 2.1 项目管理功能（基础模块）
- **组件名称**：`EventManagement.jsx`
- **功能描述**：管理运动会比赛项目，支持田赛/径赛/团体项目设置
- **主要字段**：项目名称、项目类型、性别分组、年级分组、参赛人数限制
- **技术实现**：
  - 使用Ant Design的Table、Form、Modal组件
  - 与Redux状态管理集成，使用sportsMeetSlice中的events相关action
  - 支持项目的增删改查功能

### 2.2 报名管理功能（核心优化模块）
- **组件名称**：`RegistrationManagement.jsx`
- **功能描述**：支持以班级（男、女）为单位的批量报名操作
- **核心设计**：
  - **班级视图**：按班级分组展示，每个班级分为男生和女生两个子组
  - **点选报名**：支持勾选学生进行项目报名，支持全选/取消全选
  - **批量操作**：支持批量添加/移除报名
  - **状态同步**：实时显示学生报名状态，避免重复报名
- **技术实现**：
  - 复用学生管理模块的学生数据（通过Redux获取）
  - 使用Ant Design的Table、Tree、Checkbox、Modal组件
  - 实现班级-性别-学生的树形结构展示
  - 支持跨班级、跨性别的批量操作

### 2.3 报名审核功能
- **组件名称**：`RegistrationAudit.jsx`
- **功能描述**：审核学生报名信息，确保符合项目要求
- **主要功能**：
  - 查看报名详情
  - 审核通过/拒绝报名
  - 批量审核功能
  - 异常报名提示

### 2.4 报名统计功能
- **组件名称**：`RegistrationStatistics.jsx`
- **功能描述**：统计报名情况，生成报名报表
- **主要功能**：
  - 按项目统计报名人数
  - 按班级统计报名情况
  - 按性别统计报名分布
  - 报名数据导出（Excel）

## 3. 数据结构设计

### 3.1 项目数据结构
```javascript
{
  id: '1',
  name: '100米跑',
  type: '径赛',
  gender: '男女混合', // 男女混合/男子/女子
  gradeGroups: ['一年级', '二年级'], // 参赛年级
  maxParticipants: 8, // 每组最大人数
  totalQuota: 100, // 项目总名额
  status: '报名中'
}
```

### 3.2 报名数据结构
```javascript
{
  id: '1',
  sportsMeetId: '1',
  eventId: '1',
  studentId: '1',
  studentName: '张三',
  className: '一年级1班',
  gender: '男',
  grade: '一年级',
  status: '已报名', // 已报名/审核中/已通过/已拒绝
  createdAt: '2026-01-05'
}
```

## 4. 关键页面设计

### 4.1 报名管理主页面
- **布局结构**：
  - 左侧：项目选择区（下拉选择或树状结构）
  - 中间：班级列表区（按年级-班级分组，显示班级名称、男生人数、女生人数）
  - 右侧：学生报名区（显示选中班级的男生/女生列表，支持勾选报名）
- **核心交互**：
  - 选择项目后，自动显示该项目的报名情况
  - 点击班级，展开显示男生和女生子组
  - 勾选学生，点击"添加报名"按钮完成报名
  - 支持"全选男生"、"全选女生"、"全选班级"快捷操作

### 4.2 班级学生报名视图
- **设计风格**：
  - 卡片式布局，每个班级一张卡片
  - 卡片内部分为男生和女生两个标签页
  - 每个学生显示姓名、性别、学号等基本信息
  - 已报名的学生显示"已报名"标识，不可重复勾选
- **操作流程**：
  1. 选择运动会和项目
  2. 选择年级和班级
  3. 切换男生/女生标签页
  4. 勾选需要报名的学生
  5. 点击"确认报名"按钮
  6. 系统提示报名成功

## 5. 技术实现方案

### 5.1 数据集成
- **学生数据**：直接从Redux的students状态获取，确保数据一致性
- **班级数据**：从Redux的classes状态获取，用于分组展示
- **报名数据**：存储在sportsMeetSlice的registrations状态中

### 5.2 状态管理
- **使用现有Redux状态**：
  - `students`：学生数据
  - `classes`：班级数据
  - `sportsMeet`：运动会相关数据
- **Action设计**：
  - `batchAddRegistrations`：批量添加报名
  - `batchRemoveRegistrations`：批量移除报名
  - `updateRegistrationStatus`：更新报名状态

### 5.3 UI组件选择
- **表格组件**：Ant Design Table，用于展示学生列表
- **树形组件**：Ant Design Tree，用于展示班级-性别结构
- **选择组件**：Ant Design Checkbox.Group，用于批量选择学生
- **标签页组件**：Ant Design Tabs，用于切换男生/女生视图
- **按钮组件**：Ant Design Button，用于操作按钮
- **提示组件**：Ant Design message，用于操作反馈

## 6. 开发顺序
1. **项目管理功能**：完成基础项目设置
2. **报名管理功能**：实现核心报名流程，支持班级（男、女）视图点选报名
3. **报名审核功能**：添加报名审核流程
4. **报名统计功能**：实现报名数据统计和导出
5. **测试与优化**：确保功能稳定，优化用户体验

## 7. 预期效果
- **操作效率提升**：支持批量报名，减少重复操作
- **数据准确性**：直接复用现有学生数据，避免数据不一致
- **操作便捷性**：符合小学场景，支持体育老师快速录入报名信息
- **状态清晰**：实时显示报名状态，避免重复报名
- **报表完善**：提供详细的报名统计报表，便于管理决策

## 8. 关键技术难点
- **数据关联**：确保学生数据与报名数据的正确关联
- **批量操作**：实现高效的批量报名处理
- **状态同步**：确保报名状态的实时更新和显示
- **性能优化**：处理大量学生数据时的性能问题
- **用户体验**：设计简洁直观的操作界面，减少学习成本